# ========================================
# Cowrie Configuration File
# ========================================
# LEARNING: This file controls all aspects of the honeypot
# Each section is explained in detail
# ========================================

[honeypot]

# Hostname shown to attacker
# LEARNING: Make it look realistic - common server names
hostname = server01

# SSH version string
# LEARNING: This is what attackers see when they connect
# We emulate a common OpenSSH version to attract more attacks
ssh_version_string = SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1

# Log file location
log_path = var/log/cowrie
download_path = var/lib/cowrie/downloads

# TTY log files (session recordings)
# LEARNING: These can be replayed to see exactly what attackers did
ttylog_path = var/lib/cowrie/tty

# Maximum file size for uploads/downloads (in bytes)
# LEARNING: Prevents attackers from filling up disk with huge files
download_limit_size = 10485760  # 10MB

# Authentication
# LEARNING: We want to LOG attempts, not actually authenticate
auth_class = UserDB

# Contents file for fake filesystem
# LEARNING: Cowrie has a full fake filesystem that attackers can explore
contents_path = honeyfs

# Fake filesystem architecture
# LEARNING: Emulate common server types
arch = linux-x64-lsb

# Kernel version shown in uname
kernel_version = 5.15.0-76-generic
kernel_build_string = #83-Ubuntu SMP Thu Jun 15 19:16:32 UTC 2023

# SSH specific settings
[ssh]

# Enable SSH
enabled = true

# Port to listen on
# LEARNING: 2222 instead of 22 (non-privileged)
# Use iptables to redirect 22→2222 in production
listen_endpoints = tcp:2222:interface=0.0.0.0

# Forwarding disabled
# LEARNING: Prevent attackers from using honeypot as proxy
forward_tunnel = false
sftp_enabled = true

# SSH version
version = SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1

# Public key authentication
# LEARNING: Log public keys that attackers try to use
public_key_auth = true

# Telnet settings
[telnet]

# Enable Telnet honeypot
enabled = true
listen_endpoints = tcp:2223:interface=0.0.0.0

# Telnet banner
# LEARNING: Make it look like a real device (IoT, router, etc.)
banner_file = txtcmds/banner_telnet.txt

# Output plugins
# LEARNING: Where and how to store logs
[output_jsonlog]
enabled = true
logfile = var/log/cowrie/cowrie.json
# LEARNING: JSON format is easy to parse with Logstash

[output_textlog]
enabled = true
logfile = var/log/cowrie/cowrie.log

# MySQL output (optional - we'll use JSON + Filebeat instead)
[output_mysql]
enabled = false

# ElasticSearch output (optional - we use Logstash for this)
[output_elasticsearch]
enabled = false

# Virtual Filesystem
[fs]

# Pickle file for fake filesystem
# LEARNING: This makes the honeypot feel like a real Linux system
file = share/cowrie/fs.pickle

# Username database
# LEARNING: Define what credentials we accept
# We'll create userdb.txt separately
[userdb]
userdb_file = etc/userdb.txt

# Proxy settings (if needed)
[proxy]
enabled = false

# Backend pool configuration
# LEARNING: Advanced feature - run actual VMs behind honeypot
# We won't use this, but it's how high-interaction honeypots work
[backend_pool]
enabled = false

# Malware download settings
[download]
# Save downloads
save_downloads = true

# Download URL size limit
url_download_size = 10485760  # 10MB

# Threat intelligence integration
[virustotal]
enabled = false
api_key = 
upload = false
# LEARNING: In production, enable this to auto-submit malware to VT

# MITRE ATT&CK logging
[mitre]
enabled = true
# LEARNING: Maps attacker commands to MITRE ATT&CK techniques
# Example: 'wget malware.exe' → T1105 (Ingress Tool Transfer)

# Timezone
[shell]
timezone = UTC

# Process limits
# LEARNING: Prevent resource exhaustion
processes = 20
